{% extends 'base.html' %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <!-- Post Title and Metadata -->
    <h1 class="display-4">{{ post.title }}</h1>
    <p class="text-muted">Posted on {{ post.created_on|date:"F j, Y" }}</p>

    <!-- Post Image -->
    {% if post.image %}
    <div class="text-center">
        <img src="{{ post.image.url }}" class="img-fluid rounded mb-4" alt="{{ post.title }}">
    </div>
    {% endif %}

    <!-- Post Content -->
    <div class="content">
        {{ post.content|safe }}
    </div>

    <!-- Back to Posts Link -->
    <a href="{% url 'posts' %}" class="btn btn-secondary mt-4">Back to Posts</a>

    <!-- Comments Section -->
    <hr>
    <h3 class="mt-5">Comments</h3>
    {% if post.comments.exists %}
    <ul class="list-group">
        {% for comment in post.comments.all %}
        <li class="list-group-item">
            <strong>{{ comment.author }}</strong> - {{ comment.created_on|date:"F j, Y" }}<br>
            {{ comment.body }}
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>No comments yet. Be the first to comment!</p>
    {% endif %}

    <!-- Add Comment Form -->
    <form method="post" action="" class="mt-4">
        {% csrf_token %}
        {{ comment_form.as_p }}
        <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#commentForm" aria-expanded="false" aria-controls="commentForm">
            Add Comment
        </button>
    </form>

    <!-- Sharing Options -->
    <div class="mt-5">
        <p>Share this post:</p>
        <a href="https://twitter.com/intent/tweet?text={{ post.title|urlencode }}&url={{ request.build_absolute_uri }}" target="_blank" class="btn btn-outline-primary btn-sm">
            Share on Twitter
        </a>
        <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" target="_blank" class="btn btn-outline-primary btn-sm">
            Share on Facebook
        </a>
    </div>
</div>
{% endblock %}
